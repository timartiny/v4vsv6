\section{Discussion and Conclusions} \label{sec:discussion}

In this section, we describe the limitations of our work
(\Cref{sec:discussion:limitations}), provide directions for future research
(\Cref{sec:discussion:future}), and summarize the takeaways of our work
(\Cref{sec:discussion:conclusions}).

% The design and evaluation of this experiment included many complicating factors.
% Our decision making was structured to achieve the conservative result at each
% stage. However, we provide a discussion of the limitations of our experiments in
% order to transparently contextualize our work. 
%
% This context provides an interesting vantage into future directions for pursuing
% censorship circumvention tools that leverage the gap in the transition from IPv4
% to IPv6. The inclusion of resolvers relying on 6to4 bridges demonstrates that
% the challenge facing censors in thoroughly covering the transition from IPv4 to
% IPv6 is non-trivial. In this section we evaluate the limitations of our
% measurements and analyses before proposing related future research directions
% and concluding.

\subsection{Limitations}
\label{sec:discussion:limitations}
Measuring censorship in order to gain an understanding of the underlying
infrastructure and identify weaknesses for circumvention is a challenging task
due to the absence of ground truth for validation and the often probabilistic
nature of censorship and networking failures which are easily confused.
%
Although we take care to always err on the side of caution and consider many
confounding factors including end-point type and AS diversity, our work is
fundamentally a best-effort attempt at trying to identify the gaps that have
emerged in DNS censorship deployments because of the increased adoption of
IPv6. The limitations of our study arise from three sources.

\para{External sources of data.}
Our study relies on multiple data sources including Satellite and the Citizen
Lab for our domain lists, McAfee's domain labeling services for categorizing
our data, and Maxmind's datasets for geolocating and classifying connection
types of our resolvers. Although each of these datasets has been validated in
the past and are commonly used in research, our results and their corresponding
analyses are limited by their reliability.
% 
% We draw much of the initial state for conducting our experiments and analyzing 
% the results from previous work. This includes the target domain selection as
% outlined in \Cref{sec:methodology:domains} which relies on the accuracy of the
% Satellite project. Similarly we use supplemental sources of information to
% classify and categorize our data. We specifically rely on the accuracy of the
% MaxMind geolocation and network classification datasets to inform our
% understanding of each open resolver. We also rely on the McAfee domain
% categorization system to provide categorical information about our selected
% target domains. Our results and supported analyses are limited by the
% reliability of these sources of information.

\para{Statistical limitations.}
Throughout our study, we aimed to err on the side of caution in order to avoid
presenting false-positives in our results. Therefore, we relied on rigorous
statistical approaches in order to identify differences in censorship between
{\tt A/AAAA} query and {IPv4/IPv6} network types. This included grouping
related hypotheses together and performing Sidak corrections to ensure that the
confidence level achieved across the entire group (rather than for each
individual hypothesis) was 95\%. Although this provides our results with
credibility, our strict methods almost certainly assure false-negatives. In
fact, this becomes apparent in our identification of {\tt A/AAAA}-resolvers in
China. Our statistical methods identified only six resolvers with significant
differences (\Cref{sec:resources}), however, the manual analysis performed in
the case study (\Cref{sec:cases}) shows that a much larger number of resolvers
performed censorship over a small set of just 21 domains. This is a fundamental
limitation of any test of two proportions such as the $z$-test used in this
work. 

%   Let's bring this up if they ask about it. From what I understand the stats
%   people are in two camps. Some think this is ok and others will kill
%   anything where the dist **might be** non-normal
% We filter many countries out of our statistical analysis due to the low sample
% size of available resolvers within the country. We choose specific bounds at
% which to perform analysis using the $z$-test given that we cannot guarantee that
% the resolver and domain entropy evaluation draws from a normal distribution.
% With respect to available resolvers within a country we set the lower bound at
% 25 available resolvers that pass our control tests. We believe that this
% provides our statistical tests with appropriate power to draw significant
% conclusions.

\para{Resolver selection.}
Our work required us to identify resolvers that were IPv4 and IPv6 capable. For
this, we only partially followed the steps outlined by Hendricks \etal
(\cf \Cref{sec:methodology:resolvers}). We decided not to take explicit steps
to guarantee that each resolver pair was in fact a single dual stack resolver.
Doing so would have resulted in the complete removal of 6to4 bridges and
infrastructure resolvers. Our reasoning was that such resolvers do play an
important role in the censorship apparatus since they are the ones most
commonly used by citizens in a censored region. Therefore, we decided that
their removal would have harmed (1) the representativeness of our measurements
and (2) the effectiveness of any circumvention approaches that might seek to
exploit the censorship gaps identified in this work. On the other hand, this
choice means that it is possible that our dataset may have multiple pairs of
resolvers in a country that belong to the same resolving infrastructure. 

One specific category of open resolver that we find to be relatively common in
our collected data are those that rely on a \textbf{6to4 Bridge}. This
configuration is identifiable as the resolvers IPv6 address will be drawn from
the \texttt{2002::/16} address block and has a discernable address
format~\cite{RFC3056}. The 6to4 protocol was originally designed as a mechanism
to bridge the IPv6 deployment gap as public 6to4 bridges would provide
interoperability to legacy systems such that IPv4 services could communicate
with IPv6 networks and vice-versa. The protocol works by assigning a
\texttt{/48} subnet with the encoded local address to an interface
then allowing that interface to receive traffic encapsulated in an IPv4 header
at the local address. In this way clients without outgoing connection to an IPv6
capable network can send IPv6 packets over to an IPv6 capable host who forwards
them onward.

We find many countries where IPv6 resolver availability is supplemented with
6to4 and note that the filtering stage of our resolver methodology ensures that
resolver IP pairs geolocate within the same country. This means that any IPv6
queries sent to 6to4 resolvers do traverse national networks as UDP over IPv6
for at least some potion of their path to the final resolver.

Two specific examples of a substantial 6to4 supplement are Brazil in which 94 of
the 160 resolvers identified used 6to4 and Thailand with 112 out of 186
resolvers. This understanding of the protocols that are traversing the censored
links provide a limitation on our measurement in the sense that we do not get
the pure comparison of IPv4 with IPv6 that we hoped. However, they do provide an
interesting perspective on the ability of censors to handle protocols
specifically deployed to assist in bridging the IPv4 - IPv6 gap. For example in
both Brazil and Thailand the resolvers relying on 6to4 censor requests at lower
rates of injection for requests sent over IPv6 on 6to4 as compared with Native
IPv6.

% Do the non-6to4 resolvers in bangladesh and iran cluster by domain with the
% IPv4 censoring resolvers?

\subsection{Future Work}
\label{sec:discussion:future_work}

Given the identified discrepancy in censorship effectiveness between native IPv6
addresses and 6to4 bridges a promising direction for future work is an
investigation of IP tunneling protocol usage for censorship circumvention. Our
data and particularly Table ~\ref{tab6to4} in the Appendix show that 6to4 is
censored at rates different from national averages in countries known to censor.
Further, 6to4 is not the only protocol that has seen deployment as part of an
effort to bridge the gap between IPv4 and IPv6 deployment. The \texttt{6rd}
protocol extends the subnet range of 6to4. The Teredo protocol uses UDP to
encapsulate IP traffic. Finally the ISATAP protocol provides an extended 6to4
adding configuration using multicast and DNS. This strategy is not only
applicable to DNS censorship circumvention as tunneling protocols can be used to
encapsulate any next layer.

%% It is not the only protocol designed to bridge the gap
% 6to4 - relatively static unicast encapsulation in extra IP header
% 6rd - extends subnets for 6to4
% teredo - Encapsulate in UDP
% ISATAP - provides 6to4+ using IPv6 packets encapsulated in IPv4 header and configuration using multicast and DNS.

We also propose directly extending the measurement that we have made to be
included in global longitudinal measurement studies examining DNS. The
methodology that we establish supports sustainable evaluation of global DNS
censorship.

\subsection{Conclusions}

The current state of global IPv6 DNS censorship does not divide into a binary
bifurcation block or allow, the landscape is nuanced and developing. However, we
identify clear trends in IPv6 censorship that can help motivate future research
and circumvention tool development.

In this work we present the first large scale measurement of DNS injection based
censorship in IPv6 and provide a reproducible methodology for incorporating this
measurement into longitudinal measurements going forward. We find significant
evidence of DNS injection in IPv6 in many countries around the world. We find
that cenosring countries favor native network infrastructure, censoring
\texttt{A} queries over IPv4 at the highest rates. At the country level we use
similarities and discrepancies in the censorship behavior across resolvers and
domains to identify censorship strategies. This allows us to demonstrate various
countries where censorship is likely centrally coordinated, as compared with
countries that demonstrate multiple clusters indicating looser coordination
between the entities enacting the DNS censorship regimes.

The IP layer and the gap that exists between full IPv6 deployment and the
current state of the Internet provide a telling lens for evaluating censorship
and developing censorship circumvention technologies. IPv6 plays a growing role
in global connectivity and, wherever possible, censorship measurements should
endeavor to include IPv6 analysis to provide the most actionable understanding
of global censorship infrastructure.
